{% extends 'dashboard_layout.html' %}
{% block title %}Home{% endblock %}
{% block content %}
    <!-- Dashboard Content -->
    <section class="dashboard-content">
      <!-- Dashboard Metrics -->
      <div class="dashboard-metrics">
        <div class="metric-box" onclick="{{ url_for('course') }}">Total Courses <span>{{courses}}</span></div>
        <div class="metric-box">My Courses<span>{% if my_courses.my_courses %}{{my_courses.my_courses|length}}{% else
            %}{{0}}{% endif %}</span></div>
        <!-- <div class="metric-box">Hour Spent <span>705</span></div> -->
      </div>
    
      <!-- Popular Courses -->
      <!-- <div class="grid-container"> -->

        <div style="
                    display: flex;
                    flex-direction: column;
                    height: 500px;
                    width: 100%;
                  " id="graph">
          <h2>Course Distribution by Attributes</h2>
          <iframe id="similarity-chart-frame" src="{{ url_for('home_index') }}" style="width: 100%; height: 500px; border: none"></iframe>
        </div>
      <!-- </div> -->

      <!-- Pass data to Dash app -->
      <script>
        document.addEventListener('DOMContentLoaded', function () {
          // Get the student data passed from Flask
          const studentData = {{ student_data| safe
        }};

        // Get the similarity chart iframe
        const chartFrame = document.getElementById('similarity-chart-frame');

        // When iframe loads, pass the data to it
        chartFrame.onload = function () {
          const studentDataStore = chartFrame.contentDocument.getElementById('student-data-store');
          if (studentDataStore) {
            studentDataStore.textContent = JSON.stringify(studentData);
            // Trigger change event to update chart
            const event = new Event('change');
            studentDataStore.dispatchEvent(event);
          }
        };
            });
      </script>
    </section>
        

{% endblock %}
